{% extends "web/base.html" %} {% load static %} {% block head%}
<title>Home</title>
<link rel="stylesheet" href="{% static 'web/css/index.css' %}" />

<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

{% endblock %} {% block body %}

<div class="summary-cases m-10 mt-3">
  <h3 class="text-center">Summary of Cases Worldwide</h3>
  <div clss="table-responsive">
    <table class="table table-bordered">
      <thead>
        <tr class="table text-center">
          <th scope="col">Total Cases</th>
          <th scope="col">Active</th>
          <th scope="col">Recovered</th>
          <th scope="col">Death</th>
          <th scope="col">New Cases</th>
          <th scope="col">New Death</th>
        </tr>
        <tr class="table text-center">
          <td scope="col">{{ summary.0 }}</td>
          <td scope="col">{{ summary.3 }}</td>
          <td scope="col">{{ summary.2 }}</td>
          <td scope="col">{{ summary.1 }}</td>
          <td scope="col">{{ summary.7 }}</td>
          <td scope="col">{{ summary.8 }}</td>
        </tr>
      </thead>
    </table>
  </div>
</div>

<div class="flex-fill mb-5 m-10" style="background-color: #f3f3f3;">
  <div>
    <h3 class="float-left" style="margin-left: 5%;">COVID-19 World map</h3>
    <div class="main-area float-right" style="margin-right: 5%;">
      <!-- option button -->
      <div class="btn-group" role="group" aria-label="Basic example">
        <button type="button" class="btn btn-primary" filter_type="confirmed">
          Confirmed Cases
        </button>
        <button type="button" class="btn btn-secondary" filter_type="cases_per_1m">
          Total Cases/ 1M pop
        </button>
      </div>
    </div>
    <div class="h-75 d-flex align-items-end" id="regions_div"
      style="width: 90%; height: auto; margin: 0 auto; padding-bottom: 15px;"></div>
  </div>
</div>

<div id="daily_cases_chart_div" class="m-10"></div>

<div id="daily_deaths_chart_div" class="m-10"></div>
<div class="summary-cases mt-5 m-10">
  <h3 class="text-center">Summary of Cases by Country</h3>
  <div class="tableFixHead table-responsive">
    <table class="table table-bordered">
      <thead>
        <tr class="table text-center">
          <th scope="col">Country</th>
          <th scope="col">New Cases</th>
          <th scope="col">New Deaths</th>
          <th scope="col">Total Cases</th>
          <th scope="col">Total cases/1M pop</th>

          <th scope="col">Active</th>
          <th scope="col">Recovered</th>
          <th scope="col">Death</th>
          <th scope="col">Population Data 2019</th>
        </tr>
      </thead>
      <tbody style="overflow-y: auto; height: 200px;">
        {% for country in countries %}
        <tr class="table text-center">
          <td scope="col">
            <a href="{% url 'country_view' country.0 %}" class="country_name">{{ country.0 }}</a>
          </td>
          <td scope="col" style="color: green;">{{ country.7 }}</td>
          <td scope="col" style="color: red;">{{ country.8 }}</td>
          <td scope="col">{{ country.1 }}</td>
          <td scope="col">{{ country.6 }}</td>
          <td scope="col">{{ country.4 }}</td>
          <td scope="col">{{ country.3 }}</td>
          <td scope="col">{{ country.2 }}</td>

          <td scope="col">{{ country.5 }}</td>

        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<script type="text/javascript" src="{% static 'web/js/index.js' %}"></script>
<script type="text/javascript">
  var geochart_data = {{ geochart_data| safe }};
  drawWorldMap(geochart_data);
</script>

<script>
  google.charts.load('current', { packages: ['corechart', 'bar'] });
  google.charts.setOnLoadCallback(drawTrendlines);

  function drawTrendlines() {
    var data = new google.visualization.DataTable();
    data.addColumn('date', 'Day');
    data.addColumn('number', 'Cases');

    {% for data in daily_cases_data %}
    day = new Date({{ data.0 }})
  day.setMonth(day.getMonth() - 1)
  data.addRow([day, {{ data.1 }}]);
  {% endfor %}

  var options = {
    title: 'Daily New Cases',
    trendlines: {
      0: { type: 'linear', lineWidth: 5, opacity: .3 },
    },
  }

  var chart = new google.visualization.ColumnChart(document.getElementById('daily_cases_chart_div'));
  chart.draw(data, options);
}
</script>

<script>
  google.charts.load('current', { packages: ['corechart', 'bar'] });
  google.charts.setOnLoadCallback(drawTrendlines);

  function drawTrendlines() {
    var data = new google.visualization.DataTable();
    data.addColumn('date', 'Day');
    data.addColumn('number', 'Deaths');

    {% for data in daily_deaths_data %}
    day = new Date({{ data.0 }})
  day.setMonth(day.getMonth() - 1)
  data.addRow([day, {{ data.1 }}]);
  {% endfor %}

  var options = {
    title: 'Daily New Deaths',
    trendlines: {
      0: { type: 'linear', lineWidth: 5, opacity: .3 },
    },
    colors: ['red'],
  }

  var chart = new google.visualization.ColumnChart(document.getElementById('daily_deaths_chart_div'));
  chart.draw(data, options);
}
</script>
{% endblock %}